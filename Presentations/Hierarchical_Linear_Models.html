<!DOCTYPE html>
<html lang="en"><head>
<script src="Hierarchical_Linear_Models_files/libs/clipboard/clipboard.min.js"></script>
<script src="Hierarchical_Linear_Models_files/libs/quarto-html/tabby.min.js"></script>
<script src="Hierarchical_Linear_Models_files/libs/quarto-html/popper.min.js"></script>
<script src="Hierarchical_Linear_Models_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Hierarchical_Linear_Models_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Hierarchical_Linear_Models_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Hierarchical_Linear_Models_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Hierarchical_Linear_Models_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="Hierarchical_Linear_Models_files/libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="Hierarchical_Linear_Models_files/libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <meta name="author" content="Camila Pacheco">
  <meta name="author" content="Katrín Björnsdóttir">
  <title>Linear and Hierarchical Linear Models</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Hierarchical_Linear_Models_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Hierarchical_Linear_Models_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #f07178; background-color: #2a0f15; font-weight: bold; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #00e0e0; } /* Attribute */
    code span.bn { color: #d4d0ab; } /* BaseN */
    code span.bu { color: #abe338; } /* BuiltIn */
    code span.cf { color: #ffa07a; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffd700; } /* Constant */
    code span.co { color: #f8f8f2; font-style: italic; } /* Comment */
    code span.cv { color: #ffd700; } /* CommentVar */
    code span.do { color: #f8f8f2; } /* Documentation */
    code span.dt { color: #ffa07a; } /* DataType */
    code span.dv { color: #d4d0ab; } /* DecVal */
    code span.er { color: #f07178; text-decoration: underline; } /* Error */
    code span.ex { color: #00e0e0; font-weight: bold; } /* Extension */
    code span.fl { color: #d4d0ab; } /* Float */
    code span.fu { color: #ffa07a; } /* Function */
    code span.im { color: #abe338; } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; font-weight: bold; } /* Keyword */
    code span.op { color: #ffa07a; } /* Operator */
    code span.ot { color: #00e0e0; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.re { color: #00e0e0; background-color: #f8f8f2; } /* RegionMarker */
    code span.sc { color: #abe338; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #00e0e0; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #dcc6e0; } /* Warning */
  </style>
  <link rel="stylesheet" href="Hierarchical_Linear_Models_files/libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="styles.css">
  <link href="Hierarchical_Linear_Models_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Hierarchical_Linear_Models_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Hierarchical_Linear_Models_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Hierarchical_Linear_Models_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <style>
  .v-center-container {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 90%;
  }
  </style>
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Linear and Hierarchical Linear Models</h1>
  <p class="subtitle">Mixed Models, and Multilevel Models, GLMMs, etc…</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Camila Pacheco 
</div>
</div>
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Katrín Björnsdóttir 
</div>
</div>
</div>

</section>
<section id="today" class="slide level2">
<h2>Today</h2>
<ul>
<li class="fragment">Linear Models</li>
<li class="fragment">What are hierarchical linear models</li>
<li class="fragment">Identify situations in which the use of mixed effects is appropriate</li>
<li class="fragment">Implement basic linear mixed models (LMM) with <code>R</code></li>
<li class="fragment">Break <i class="fa-solid fa-face-smile" aria-label="face-smile"></i></li>
<li class="fragment">Practice</li>
</ul>
<div class="fragment">
<p><img src="https://media1.tenor.com/m/oTeBa4EVepMAAAAC/business-cat-working.gif"></p>
</div>
</section>
<section id="required-material" class="slide level2">
<h2>Required Material</h2>
<p>You are required to have downloaded and installed</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"lme4"</span>,</span>
<span id="cb1-2"><a href="#cb1-2"></a>                      <span class="st">"ggeffects"</span>,</span>
<span id="cb1-3"><a href="#cb1-3"></a>                      <span class="st">"stargazer"</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>                      ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="required-material-1" class="slide level2">
<h2>Required Material</h2>
<div class="v-center-container">
<h4>
Do not hesitate to ask questions!
</h4>
</div>
</section>
<section id="linear-models" class="slide level2">
<h2>Linear models</h2>
</section>
<section id="linear-models-1" class="slide level2">
<h2>Linear models</h2>
<p>Now we want to test if there is a relationship between petal length and petal width. For that we run a simple linear model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>iris.m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Petal.Length <span class="sc">~</span> Petal.Width, <span class="at">data =</span> iris)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">summary</span>(iris.m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Petal.Length ~ Petal.Width, data = iris)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.33542 -0.30347 -0.02955  0.25776  1.39453 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.08356    0.07297   14.85   &lt;2e-16 ***
Petal.Width  2.22994    0.05140   43.39   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4782 on 148 degrees of freedom
Multiple R-squared:  0.9271,    Adjusted R-squared:  0.9266 
F-statistic:  1882 on 1 and 148 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>The summary function gives you the output from the model. We can see that petal width significantly effects petal length (as you might have expected). Our model did <em>very</em> good, explaining about 93% of the variation in petal length.</p>
</section>
<section id="linear-models-2" class="slide level2">
<h2>Linear models</h2>
<p>Do we expect there to be a difference between species? Lets add species as an interaction to make it a bit more complicated.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>iris.m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Petal.Length <span class="sc">~</span> Petal.Width <span class="sc">*</span> Species, <span class="at">data =</span> iris)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">summary</span>(iris.m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Petal.Length ~ Petal.Width * Species, data = iris)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.84099 -0.19343 -0.03686  0.16314  1.17065 

Coefficients:
                              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                     1.3276     0.1309  10.139  &lt; 2e-16 ***
Petal.Width                     0.5465     0.4900   1.115   0.2666    
Speciesversicolor               0.4537     0.3737   1.214   0.2267    
Speciesvirginica                2.9131     0.4060   7.175 3.53e-11 ***
Petal.Width:Speciesversicolor   1.3228     0.5552   2.382   0.0185 *  
Petal.Width:Speciesvirginica    0.1008     0.5248   0.192   0.8480    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3615 on 144 degrees of freedom
Multiple R-squared:  0.9595,    Adjusted R-squared:  0.9581 
F-statistic: 681.9 on 5 and 144 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="linear-models-3" class="slide level2">
<h2>Linear models</h2>
<p>Now lets visualize the relationship using ggplot (notice how we only included stat`smooth to our original scatter plot).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>p<span class="ot">&lt;-</span>iris <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb6-3"><a href="#cb6-3"></a>    <span class="at">x =</span> Petal.Length,</span>
<span id="cb6-4"><a href="#cb6-4"></a>    <span class="at">y =</span> Petal.Width,</span>
<span id="cb6-5"><a href="#cb6-5"></a>    <span class="at">color =</span> Species)) <span class="sc">+</span> <span class="co"># to assign a color to each group</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> Species, <span class="at">colour =</span> Species)) <span class="sc">+</span>    </span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="fu">labs</span>(</span>
<span id="cb6-9"><a href="#cb6-9"></a>    <span class="at">x =</span> <span class="st">"Petal length (cm)"</span>,</span>
<span id="cb6-10"><a href="#cb6-10"></a>    <span class="at">y =</span> <span class="st">"Petal width (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="linear-models-4" class="slide level2">
<h2>Linear models</h2>

<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch"></section>
<section id="linear-models-5" class="slide level2">
<h2>Linear models</h2>
<p>In the previous plot we just made we used the default ggplot settings. Although this is a great looking plot, we can make it even better since ggplot has a lot of power in customization, here is one example but feel free to play around with this, it can actually be quite satisfying when you get the hang of it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>p<span class="ot">&lt;-</span>iris <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb7-3"><a href="#cb7-3"></a>    <span class="at">x =</span> Petal.Length,</span>
<span id="cb7-4"><a href="#cb7-4"></a>    <span class="at">y =</span> Petal.Width,</span>
<span id="cb7-5"><a href="#cb7-5"></a>    <span class="at">color =</span> Species <span class="co"># to assign a color to each group</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>  )) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="co"># to plot a scatter plot</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> Species, <span class="at">colour =</span> Species), <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span> <span class="co">#add a linear fit for each species</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Species"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#023d79"</span>, <span class="st">"#faa307"</span>, <span class="st">"#3f5426"</span>)) <span class="sc">+</span> <span class="co">#add manually selected colors to the points of different species</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Species"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#023d79"</span>, <span class="st">"#faa307"</span>, <span class="st">"#3f5426"</span>)) <span class="sc">+</span> <span class="co">#add manually selected colors to the linear fit for each species</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-12"><a href="#cb7-12"></a>    <span class="at">x =</span> <span class="st">"Petal length (cm)"</span>, <span class="co">#x axis label</span></span>
<span id="cb7-13"><a href="#cb7-13"></a>    <span class="at">y =</span> <span class="st">"Petal width (cm)"</span> <span class="co">#y axis label </span></span>
<span id="cb7-14"><a href="#cb7-14"></a>  ) <span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span> <span class="co">#theme within the ggplot2 package (different themes available, f.ex. theme_classic, theme_minimal)</span></span>
<span id="cb7-16"><a href="#cb7-16"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>), <span class="co">#use the theme function to customize axis text, label test, legends etc.</span></span>
<span id="cb7-17"><a href="#cb7-17"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb7-18"><a href="#cb7-18"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"plain"</span>),             </span>
<span id="cb7-19"><a href="#cb7-19"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"plain"</span>),             </span>
<span id="cb7-20"><a href="#cb7-20"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-21"><a href="#cb7-21"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-22"><a href="#cb7-22"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-23"><a href="#cb7-23"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-24"><a href="#cb7-24"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">units =</span> , <span class="st">"cm"</span>),</span>
<span id="cb7-25"><a href="#cb7-25"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb7-26"><a href="#cb7-26"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"italic"</span>),          </span>
<span id="cb7-27"><a href="#cb7-27"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="linear-models-6" class="slide level2">
<h2>Linear models</h2>

<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"></section>
<section id="generalize-linear-models" class="slide level2">
<h2>Generalize linear models</h2>
<p>Get familiar with different data distributions Here is a brief summary of the data distributions you might encounter most often.</p>
<ul>
<li class="fragment">Gaussian - Continuous data (normal distribution and homoscedasticity assumed)</li>
<li class="fragment">Poisson - Count abundance data (integer values, zero-inflated data, left-skewed data)</li>
<li class="fragment">Binomial - Binary variables (TRUE/FALSE, 0/1, presence/absence data)</li>
</ul>
<div class="fragment">
<p>Choosing the right statistical test for your analysis is an important step about which you should think carefully.</p>
</div>
</section>
<section id="generalize-linear-models-1" class="slide level2">
<h2>Generalize linear models</h2>
<div style="background-color:white; display:inline-block; padding: 10px;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://ourcodingclub.github.io/assets/img/tutorials/modelling/DL_intro_lm_which.png"></p>
<figcaption>lm which</figcaption>
</figure>
</div>
</div>
</section>
<section id="generalize-linear-models-2" class="slide level2">
<h2>Generalize linear models</h2>
<p>Syntax for a model with poisson (count) distribution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">family =</span> poisson, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Syntax for a model with binomial distribution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">family =</span> binomial, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="hierarchical-linear-models" class="slide level2">
<h2>Hierarchical Linear Models</h2>
</section>
<section id="ecological-and-biological-data-can-be-complex" class="slide level2">
<h2>Ecological and biological data can be complex!</h2>
<ul>
<li class="fragment"><p>Hierarchical structure in the data</p></li>
<li class="fragment"><p>Many covariates and grouping factors</p></li>
<li class="fragment"><p>Unbalanced study/experimental design</p></li>
</ul>
</section>
<section id="what-is-independence-assumption" class="slide level2">
<h2>What is Independence Assumption?</h2>
<p>A linear regression model assumes that :</p>
<div class="fragment">
<p><em>Any other data point does not influence each data point in a dataset</em></p>
</div>
<ul>
<li class="fragment"><p>We are <strong>NOT</strong> referring to your independent and responses variable</p></li>
<li class="fragment"><p><em>Ideally</em> we want them to be correlated it</p></li>
</ul>
<div class="fragment">
<p>We are referring withing the variable</p>
</div>
</section>
<section id="diagnosis-of-dependence" class="slide level2">
<h2>Diagnosis of dependence?</h2>
<p>Think about how the data were collected.</p>
<div class="fragment">
<p><strong>Are there clusters in my data?</strong></p>
</div>
<div class="fragment">
<p>For example:</p>
</div>
<div class="fragment">
<p>Are there data from individual species clustered within sampling area?</p>
</div>
</section>
<section id="hierarchical-structres-example" class="slide level2">
<h2>Hierarchical structres example</h2>

<img data-src="Hierarchical_Linear_Models_files/Figures/hierarchical_example.png" style="width:100.0%" class="r-stretch"></section>
<section id="hierarchical-structres-in-ecology" class="slide level2">
<h2>Hierarchical structres in ecology</h2>
<ul>
<li class="fragment">Grouping factors: populations, species, sites</li>
<li class="fragment">Sample sizes: Species area relationship</li>
<li class="fragment">Time: Might take repeated measurements of the same plant in time</li>
<li class="fragment">Space: the closer the similar</li>
</ul>
</section>
<section id="how-could-we-analyze-this-data" class="slide level2">
<h2>How could we analyze this data?</h2>
<p>We need to explicitly account for the correlated nature of the data</p>
<div class="fragment">
<p>The <em>random effects</em> structure will aid correct inference about <em>fixed effects</em>, depending on which level of the system’s hierarchy is being manipulated.</p>
</div>
<ul>
<li class="fragment">What is random effects ?</li>
<li class="fragment">What is fixed effects?</li>
<li class="fragment">When to used them ?</li>
</ul>
</section>
<section id="when-to-used-them" class="slide level2">
<h2>When to used them ?</h2>
<p>You will need to used random and fixed effects every time your data has a <strong>Hierarchical</strong> structure.</p>
<ul>
<li class="fragment"><p>It’s important to not that this difference has little to do with the variables themselves, and a lot to do with your research question!</p></li>
<li class="fragment"><p>What is just variation (“<strong>noise</strong>”) that you need to control for?</p></li>
</ul>
</section>
<section id="fixed-effects-deterministic-processes" class="slide level2">
<h2>Fixed effects : deterministic processes</h2>
<ul>
<li class="fragment"><p>They are like drivers, categories or groups that you think might directly influence the outcome you’re studying.</p></li>
<li class="fragment"><p>They’re called “<em>fixed</em>” because you’re interested in the specific levels of these categories.</p></li>
<li class="fragment"><p><code>"I want to know how these different things (fixed effects) affect the outcome."</code></p></li>
<li class="fragment"><p>levels of a factor (qualitative variable)</p></li>
<li class="fragment"><p>a predictor (quantitative variable)</p></li>
</ul>
</section>
<section id="random-effects-stochastic-processes" class="slide level2">
<h2>Random effects : stochastic processes</h2>
<ul>
<li class="fragment">Name random doesn’t have much to do with mathematical randomness</li>
<li class="fragment">They are like grouping factors for which we are trying to control</li>
<li class="fragment">You’re not interested in the specific effect of these factors themselves</li>
<li class="fragment">but we know that they might be influencing the patterns we see</li>
<li class="fragment"><code>"I want to know how these factors (random effects) contribute to the overall variation in the outcome."</code></li>
<li class="fragment">They are always categorical</li>
</ul>
</section>
<section id="data-for-this-part-of-the-session" class="slide level2">
<h2>Data for this part of the session</h2>

<img data-src="https://static1.srcdn.com/wordpress/wp-content/uploads/2022/08/Illustrations-of-various-dragons-from-Dungeons-and-Dragons.jpg" style="width:80.0%" class="r-stretch"><p><a href="https://ourcodingclub.github.io/tutorials/mixed-models/">Coding Club Mixed models</a></p>
</section>
<section id="explore-the-data" class="slide level2">
<h2>Explore the data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">load</span>(<span class="st">"CC-Linear-mixed-models/dragons.RData"</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="fu">head</span>(dragons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  testScore bodyLength mountainRange site
1 16.147309   165.5485      Bavarian    a
2 33.886183   167.5593      Bavarian    a
3  6.038333   165.8830      Bavarian    a
4 18.838821   167.6855      Bavarian    a
5 33.862328   169.9597      Bavarian    a
6 47.043246   168.6887      Bavarian    a</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">hist</span>(dragons<span class="sc">$</span>testScore)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-13-1.png" width="960" class="r-stretch"></section>
<section id="scaling-the-data" class="slide level2">
<h2>Scaling the data</h2>
<p>It is good practice to standardize your explanatory variables before proceeding so that they have a mean of zero (“centering”) and standard deviation of one (“scaling”).</p>
<p>If two variables in the same model have very different scales, the mixed model will likely return a <code>convergence error</code> when trying to compute the parameters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>dragons<span class="ot">&lt;-</span> dragons <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">mutate</span>(<span class="at">bodyLength2=</span><span class="fu">scale</span>(bodyLength,<span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="research-question" class="slide level2">
<h2>Research question</h2>
<div class="v-center-container">
<h4>
Is the test score affected by body length?
</h4>
</div>
</section>
<section id="linear-model" class="slide level2">
<h2>Linear model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>basic.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(testScore <span class="sc">~</span> bodyLength2, <span class="at">data =</span> dragons)</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="fu">summary</span>(basic.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = testScore ~ bodyLength2, data = dragons)

Residuals:
    Min      1Q  Median      3Q     Max 
-56.962 -16.411  -0.783  15.193  55.200 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  50.3860     0.9676  52.072   &lt;2e-16 ***
bodyLength2   8.9956     0.9686   9.287   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 21.2 on 478 degrees of freedom
Multiple R-squared:  0.1529,    Adjusted R-squared:  0.1511 
F-statistic: 86.25 on 1 and 478 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="linear-model-1" class="slide level2">
<h2>Linear model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>(prelim_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dragons, <span class="fu">aes</span>(<span class="at">x =</span> bodyLength, <span class="at">y =</span> testScore)) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>))<span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-16-1.png" width="960" class="r-stretch"><ul>
<li class="fragment">it seems like bigger dragons do better in our intelligence test. That seems a bit odd: size shouldn’t really affect the test scores.</li>
</ul>
</section>
<section id="assumptions-check" class="slide level2">
<h2>Assumptions check</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">plot</span>(basic.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-17-1.png" width="960"></p>
</div>
<div class="cell-output-display">
<p><img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-17-2.png" width="960"></p>
</div>
<div class="cell-output-display">
<p><img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-17-3.png" width="960"></p>
</div>
<div class="cell-output-display">
<p><img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-17-4.png" width="960"></p>
</div>
</div>
</section>
<section id="assumptions-check-1" class="slide level2">
<h2>Assumptions check</h2>
<div class="v-center-container">
<h4>
Are our data independent?
</h4>
</div>
</section>
<section id="assumptions-check-2" class="slide level2">
<h2>Assumptions check</h2>
<p><code>Data description:</code> The data were collected from multiple samples from eight mountain ranges.</p>
<ul>
<li class="fragment">It’s perfectly plausible that the data from within each mountain range are more similar to each other than the data from different mountain ranges</li>
<li class="fragment">they are Hierarchical!</li>
</ul>
</section>
<section id="assumptions-check-3" class="slide level2">
<h2>Assumptions check</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>(colour_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dragons, <span class="fu">aes</span>(<span class="at">x =</span> bodyLength, <span class="at">y =</span> testScore, <span class="at">colour =</span> mountainRange)) <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-18-1.png" width="960" class="r-stretch"></section>
<section id="how-to-implement-mixed-models-in-r" class="slide level2">
<h2>How to implement mixed models in R?</h2>
<ul>
<li class="fragment">Step 1: Model building</li>
<li class="fragment">Step 2: Model validation</li>
<li class="fragment">Step 3: Model interpretation</li>
<li class="fragment">Step 4: Model visualization</li>
</ul>
</section>
<section id="step-1-model-building" class="slide level2">
<h2>Step 1: Model building</h2>
<p>Hierarchical linear models do is they essentially fit a separate regression line for each and every cluster.</p>
</section>
<section id="step-1-model-building-dragons" class="slide level2">
<h2>Step 1: Model building Dragons</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>(colour_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dragons, <span class="fu">aes</span>(<span class="at">x =</span> bodyLength, <span class="at">y =</span> testScore, <span class="at">colour =</span> mountainRange)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,<span class="at">se=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>  <span class="fu">theme_classic</span>() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-19-1.png" width="960" class="r-stretch"></section>
<section id="step-1-model-building-1" class="slide level2">
<h2>Step 1: Model building</h2>
<p>Hierarchical linear models do is they essentially fit a separate regression line for each and every cluster. And then estimates what we call the <em>Fixed slope</em>. Average slope between x and y across my clusters.</p>
<div class="fragment">
<p>Mathematically speaking it is more complicated than that.</p>
</div>
</section>
<section id="step-1-model-building-dragons-1" class="slide level2">
<h2>Step 1: Model building Dragons</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" data-code-line-numbers="|1|2|3|4|5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">library</span>(lme4) <span class="co">#"linear mixed model" function from lme4 package</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>mixed.lmer <span class="ot">&lt;-</span> <span class="fu">lmer</span>(testScore <span class="sc">~</span> bodyLength2 <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>                     (<span class="dv">1</span><span class="sc">|</span>mountainRange), <span class="co">#random effect</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>                   <span class="at">data =</span> dragons,</span>
<span id="cb20-5"><a href="#cb20-5"></a>                   <span class="at">REML =</span> <span class="cn">TRUE</span> <span class="co">#estimation method other method ML but it has a bias</span></span>
<span id="cb20-6"><a href="#cb20-6"></a>                   )</span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="fu">summary</span>(mixed.lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: testScore ~ bodyLength2 + (1 | mountainRange)
   Data: dragons

REML criterion at convergence: 3985.6

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.4815 -0.6513  0.0066  0.6685  2.9583 

Random effects:
 Groups        Name        Variance Std.Dev.
 mountainRange (Intercept) 339.7    18.43   
 Residual                  223.8    14.96   
Number of obs: 480, groups:  mountainRange, 8

Fixed effects:
            Estimate Std. Error t value
(Intercept)  50.3860     6.5517   7.690
bodyLength2   0.5377     1.2750   0.422

Correlation of Fixed Effects:
            (Intr)
bodyLength2 0.000 </code></pre>
</div>
</div>
</section>
<section id="step-1-model-building-dragons-2" class="slide level2">
<h2>Step 1: Model building Dragons</h2>
<p>Mountain ranges are clearly important: they explain a lot of variation:</p>
<table>
<thead>
<tr class="header">
<th>Factor</th>
<th>Variance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mountain range</td>
<td>339.7</td>
</tr>
<tr class="even">
<td>Residuals</td>
<td>223.8</td>
</tr>
<tr class="odd">
<td>Body length</td>
<td>?</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>(<span class="fl">339.7</span><span class="sc">/</span>(<span class="fl">339.7</span> <span class="sc">+</span> <span class="fl">223.8</span>) )<span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 60.28394</code></pre>
</div>
</div>
<div class="fragment">
<p>Variance Body length</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="dv">100</span><span class="fl">-60.28</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 39.72</code></pre>
</div>
</div>
</div>
</section>
<section id="step-2-model-validation-dragons" class="slide level2">
<h2>Step 2: Model validation Dragons</h2>
<p>Assumptions check</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">plot</span>(mixed.lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-23-1.png" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(mixed.lmer))</span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(mixed.lmer))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-23-2.png" width="960"></p>
</div>
</div>
</section>
<section id="step-1-model-building-nesting" class="slide level2">
<h2>Step 1: Model building Nesting</h2>
<p>Example:</p>
<p>10 control | 10 experimental</p>
<ul>
<li class="fragment"><p>3 years</p></li>
<li class="fragment"><p>Each season</p></li>
<li class="fragment"><p>20 beds</p></li>
<li class="fragment"><p>50 seedlings</p></li>
<li class="fragment"><p>5 leaves</p></li>
<li class="fragment"><p>5 leaves x 50 seedlings x 20 beds x 4 seasons x 3 years = 60 000 measurements per treatment</p></li>
</ul>
</section>
<section id="step-1-model-building-nesting-1" class="slide level2">
<h2>Step 1: Model building Nesting</h2>
<p>Effect of treatment in leaf length</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>leafLength <span class="sc">~</span> treatment </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<ul>
<li class="fragment"><em>Pseudoreplication</em></li>
<li class="fragment">Massively increasing sampling size</li>
</ul>
</div>
<div class="fragment">
<p>Better model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>leafLength <span class="sc">~</span> treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Bed<span class="sc">/</span>Plant<span class="sc">/</span>Leaf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>What about the crossed effects ?</p>
<ul>
<li class="fragment">Crossed (or partially crossed) random factors that do not represent levels in a hierarchy.</li>
<li class="fragment">This account for the fact that all plants in the experiment, regardless of the fixed (treatment) effect, may have experienced a very hot summer in the second year.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>leafLength <span class="sc">~</span> treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Bed<span class="sc">/</span>Plant<span class="sc">/</span>Leaf) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Season)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="step-1-model-building-dragons-nesting" class="slide level2">
<h2>Step 1: Model building Dragons Nesting</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" data-code-line-numbers="|2|5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>mixed.lmer2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(testScore <span class="sc">~</span> bodyLength2<span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>                      (<span class="dv">1</span><span class="sc">|</span>mountainRange<span class="sc">/</span>site),</span>
<span id="cb31-3"><a href="#cb31-3"></a>                    <span class="at">data =</span> dragons)  </span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="fu">summary</span>(mixed.lmer2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: testScore ~ bodyLength2 + (1 | mountainRange/site)
   Data: dragons

REML criterion at convergence: 3970.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2425 -0.6752 -0.0117  0.6974  2.8812 

Random effects:
 Groups             Name        Variance Std.Dev.
 site:mountainRange (Intercept)  23.09    4.805  
 mountainRange      (Intercept) 327.56   18.099  
 Residual                       208.58   14.442  
Number of obs: 480, groups:  site:mountainRange, 24; mountainRange, 8

Fixed effects:
            Estimate Std. Error t value
(Intercept)   50.386      6.507   7.743
bodyLength2    0.831      1.681   0.494

Correlation of Fixed Effects:
            (Intr)
bodyLength2 0.000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb33" data-code-line-numbers="|2|5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>mixed.lmer3 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(testScore <span class="sc">~</span> bodyLength2</span>
<span id="cb33-2"><a href="#cb33-2"></a>                    <span class="sc">+</span>(<span class="dv">1</span><span class="sc">|</span>mountainRange) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>mountainRange<span class="sc">:</span>site),</span>
<span id="cb33-3"><a href="#cb33-3"></a>                    <span class="at">data =</span> dragons)</span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="fu">summary</span>(mixed.lmer3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: 
testScore ~ bodyLength2 + (1 | mountainRange) + (1 | mountainRange:site)
   Data: dragons

REML criterion at convergence: 3970.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2425 -0.6752 -0.0117  0.6974  2.8812 

Random effects:
 Groups             Name        Variance Std.Dev.
 mountainRange:site (Intercept)  23.09    4.805  
 mountainRange      (Intercept) 327.56   18.099  
 Residual                       208.58   14.442  
Number of obs: 480, groups:  mountainRange:site, 24; mountainRange, 8

Fixed effects:
            Estimate Std. Error t value
(Intercept)   50.386      6.507   7.743
bodyLength2    0.831      1.681   0.494

Correlation of Fixed Effects:
            (Intr)
bodyLength2 0.000 </code></pre>
</div>
</div>
</section>
<section id="step-1-model-building-dragons-nesting-1" class="slide level2">
<h2>Step 1: Model building Dragons Nesting</h2>

<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-28-1.png" width="960" class="r-stretch"></section>
<section id="random-slopes-and-random-intercept" class="slide level2">
<h2>Random slopes and Random intercept</h2>
<div class="fragment fade-in">
<p>A <em>random-intercept</em> model recognizes that each cluster might have its own starting point (intercept), but keeps the slope constant among them. So in our example we acknowledge that some populations may be smarter or dumber to begin with.</p>
</div>
<div class="fragment fade-in">
<p><em>Lets say</em> we expect that dragons in all mountain ranges do not exhibit the same relationship between body length and intelligence (rando, slope)</p>
</div>
</section>
<section id="random-slopes-and-random-intercept-1" class="slide level2">
<h2>Random slopes and Random intercept</h2>
<p>We only need to make one change to our model to allow for random slopes as well as intercept, and that’s adding the fixed variable into the random effect brackets:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" data-code-line-numbers="|2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>mixed.ranslope <span class="ot">&lt;-</span> <span class="fu">lmer</span>(testScore <span class="sc">~</span> bodyLength2 <span class="sc">+</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>                         (<span class="dv">1</span> <span class="sc">+</span> bodyLength2<span class="sc">|</span>mountainRange<span class="sc">/</span>site), </span>
<span id="cb35-3"><a href="#cb35-3"></a>                       <span class="at">data =</span> dragons) </span>
<span id="cb35-4"><a href="#cb35-4"></a></span>
<span id="cb35-5"><a href="#cb35-5"></a><span class="fu">summary</span>(mixed.ranslope)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: testScore ~ bodyLength2 + (1 + bodyLength2 | mountainRange/site)
   Data: dragons

REML criterion at convergence: 3968.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2654 -0.6737 -0.0200  0.6931  2.8432 

Random effects:
 Groups             Name        Variance Std.Dev. Corr 
 site:mountainRange (Intercept)  19.8156  4.4515       
                    bodyLength2   0.7178  0.8472  1.00 
 mountainRange      (Intercept) 310.9691 17.6343       
                    bodyLength2   6.1119  2.4722  -1.00
 Residual                       208.5025 14.4396       
Number of obs: 480, groups:  site:mountainRange, 24; mountainRange, 8

Fixed effects:
            Estimate Std. Error t value
(Intercept)  51.4263     6.3408   8.110
bodyLength2   0.6691     1.8729   0.357

Correlation of Fixed Effects:
            (Intr)
bodyLength2 -0.461
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
</section>
<section id="random-slopes-and-random-intercept-2" class="slide level2">
<h2>Random slopes and Random intercept</h2>

<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-30-1.png" width="960" class="r-stretch"></section>
<section id="step-3-model-interpretation" class="slide level2">
<h2>Step 3: Model interpretation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="fu">stargazer</span>(mixed.lmer2,</span>
<span id="cb37-3"><a href="#cb37-3"></a>          <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb37-4"><a href="#cb37-4"></a>          <span class="at">type=</span><span class="st">"text"</span>,</span>
<span id="cb37-5"><a href="#cb37-5"></a>          <span class="at">star.cutoffs =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>),</span>
<span id="cb37-6"><a href="#cb37-6"></a>          <span class="at">digit.separator =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=================================================
                         Dependent variable:     
                    -----------------------------
                              testScore          
-------------------------------------------------
bodyLength2                     0.831            
                               (1.681)           
                                                 
Constant                      50.386***          
                               (6.507)           
                                                 
-------------------------------------------------
Observations                     480             
Log Likelihood                -1985.195          
Akaike Inf. Crit.             3980.389           
Bayesian Inf. Crit.           4001.258           
=================================================
Note:               *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</code></pre>
</div>
</div>
</section>
<section id="step-4.-visualization" class="slide level2">
<h2>Step 4. Visualization</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb39" data-code-line-numbers="1|3-4|6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb39-2"><a href="#cb39-2"></a></span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="co"># Extract the prediction data frame</span></span>
<span id="cb39-4"><a href="#cb39-4"></a>pred.mm <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(mixed.lmer2, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"bodyLength2"</span>))  <span class="co"># this gives overall predictions for the model</span></span>
<span id="cb39-5"><a href="#cb39-5"></a><span class="fu">head</span>(pred.mm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Predicted values of testScore

bodyLength2 | Predicted |       95% CI
--------------------------------------
         -3 |     47.89 | 31.72, 64.07
         -2 |     48.72 | 34.33, 63.12
         -1 |     49.56 | 36.35, 62.76
          0 |     50.39 | 37.60, 63.17
          1 |     51.22 | 38.01, 64.42
          2 |     52.05 | 37.66, 66.44

Adjusted for:
*          site = 0 (population-level)
* mountainRange = 0 (population-level)</code></pre>
</div>
</div>
</section>
<section id="step-4.-visualization-1" class="slide level2">
<h2>Step 4. Visualization</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb41" data-code-line-numbers="|3-4|5-13|13-17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># Plot the predictions </span></span>
<span id="cb41-2"><a href="#cb41-2"></a>p<span class="ot">&lt;-</span><span class="fu">ggplot</span>(pred.mm) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3"></a>    <span class="co"># slope</span></span>
<span id="cb41-4"><a href="#cb41-4"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> predicted)) <span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5"></a>    <span class="co"># error band</span></span>
<span id="cb41-6"><a href="#cb41-6"></a>    <span class="fu">geom_ribbon</span>(</span>
<span id="cb41-7"><a href="#cb41-7"></a>      <span class="fu">aes</span>(</span>
<span id="cb41-8"><a href="#cb41-8"></a>        <span class="at">x =</span> x,</span>
<span id="cb41-9"><a href="#cb41-9"></a>        <span class="at">ymin =</span> predicted <span class="sc">-</span> std.error,</span>
<span id="cb41-10"><a href="#cb41-10"></a>        <span class="at">ymax =</span> predicted <span class="sc">+</span> std.error</span>
<span id="cb41-11"><a href="#cb41-11"></a>      ),</span>
<span id="cb41-12"><a href="#cb41-12"></a>      <span class="at">fill =</span> <span class="st">"lightgrey"</span>,</span>
<span id="cb41-13"><a href="#cb41-13"></a>      <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb41-14"><a href="#cb41-14"></a>    ) <span class="sc">+</span></span>
<span id="cb41-15"><a href="#cb41-15"></a>    <span class="co"># adding the raw data (scaled values)</span></span>
<span id="cb41-16"><a href="#cb41-16"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> dragons,                      </span>
<span id="cb41-17"><a href="#cb41-17"></a>               <span class="fu">aes</span>(<span class="at">x =</span> bodyLength2, <span class="at">y =</span> testScore, <span class="at">colour =</span> mountainRange)) <span class="sc">+</span></span>
<span id="cb41-18"><a href="#cb41-18"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Body Length (indexed)"</span>,</span>
<span id="cb41-19"><a href="#cb41-19"></a>         <span class="at">y =</span> <span class="st">"Test Score"</span>,</span>
<span id="cb41-20"><a href="#cb41-20"></a>         <span class="at">title =</span> <span class="st">"Body length does not affect intelligence in dragons"</span>) <span class="sc">+</span></span>
<span id="cb41-21"><a href="#cb41-21"></a>    <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-4.-visualization-2" class="slide level2">
<h2>Step 4. Visualization</h2>

<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-34-1.png" width="960" class="r-stretch"></section>
<section id="step-4.-visualization-3" class="slide level2">
<h2>Step 4. Visualization</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42" data-code-line-numbers="|3|4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>p<span class="ot">&lt;-</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>  <span class="fu">ggpredict</span>(mixed.lmer2, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"bodyLength2"</span>, <span class="st">"mountainRange"</span>),</span>
<span id="cb42-3"><a href="#cb42-3"></a>            <span class="at">type =</span> <span class="st">"random"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-4"><a href="#cb42-4"></a>   <span class="fu">plot</span>(<span class="at">show_ci =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Body Length"</span>, <span class="at">y =</span> <span class="st">"Test Score"</span>, </span>
<span id="cb42-6"><a href="#cb42-6"></a>        <span class="at">title =</span> <span class="st">"Effect of body size on intelligence in dragons"</span>) <span class="sc">+</span> </span>
<span id="cb42-7"><a href="#cb42-7"></a>   <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-4.-visualization-4" class="slide level2">
<h2>Step 4. Visualization</h2>

<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-36-1.png" width="960" class="r-stretch"></section>
<section id="additional-ressources" class="slide level2">
<h2>Additional ressources</h2>
<p>Popular libraries for (G)LMMs:</p>
<ul>
<li class="fragment"><p>Frequentist : <code>nlme</code>, <code>lme4</code>, <code>glmmTMB</code></p></li>
<li class="fragment"><p>Bayesian : <code>brms</code>, <code>rstan</code>, <code>rstanarm</code>, <code>MCMCglmm</code></p></li>
<li class="fragment"><p>Nice visualization : <a href="https://mfviz.com/hierarchical-models/">link</a></p></li>
<li class="fragment"><p>Visit: <a href="https://ourcodingclub.github.io/">Coding Club</a></p></li>
</ul>
</section>
<section id="break" class="slide level2">
<h2>BREAK</h2>

<img data-src="https://assets-global.website-files.com/647888ca92d03e3fca3f1ea0/647888ca92d03e3fca3f2376_shutterstock_792140977.jpg" style="width:100.0%" class="r-stretch"></section>
<section id="exercise" class="slide level2">
<h2>Exercise</h2>
<p>Now let’s practice …</p>
<div class="fragment">
<p><img src="https://media1.tenor.com/m/hHaVzeiH-hcAAAAC/imsickofwork-technologysu-x.gif"></p>
</div>
</section>
<section id="itex" class="slide level2">
<h2>ITEX</h2>
<p>We will be using a dataset from the ITEX network.</p>
<ul>
<li class="fragment"><p>ITEX is a long-term warming experiment that uses standardized protocols to examine impacts of warming on Arctic ecosystems.</p></li>
<li class="fragment"><p>Established in the 1990s - vegetation monitoring over three decades.</p></li>
<li class="fragment"><p>Uses a simple method that is easy to establish in the field - open top chambers</p></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="Hierarchical_Linear_Models_files/Figures/otc.png" style="width:20.0%"></p>
</div>
</div>
</div>
</section>
<section id="itex-1" class="slide level2">
<h2>ITEX</h2>

<img data-src="Hierarchical_Linear_Models_files/Figures/audkuluheidi.JPG" style="width:100.0%" class="r-stretch"></section>
<section id="lets-look-at-the-data" class="slide level2">
<h2>Let’s look at the data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>itex <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/ITEX_diversity_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">head</span>(itex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 11
   ...1 SITE      SUBSITE     PLOT   YEAR TRTMT Latitude WarmQuarterTemp SppRich
  &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;           &lt;dbl&gt;   &lt;dbl&gt;
1     1 ALEXFIORD ALEXFIORD:… Cas.…  2007 CTL       78.9            25.6       9
2     2 ALEXFIORD ALEXFIORD:… Cas.…  2007 CTL       78.9            25.6       9
3     3 ALEXFIORD ALEXFIORD:… Cas.…  2007 CTL       78.9            25.6       7
4     4 ALEXFIORD ALEXFIORD:… Cas.…  2007 CTL       78.9            25.6       8
5     5 ALEXFIORD ALEXFIORD:… Cas.…  2007 CTL       78.9            25.6       6
6     6 ALEXFIORD ALEXFIORD:… Cas.…  2007 CTL       78.9            25.6      10
# ℹ 2 more variables: `row_number()` &lt;dbl&gt;, PlotTemp &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(itex<span class="sc">$</span>SITE)) <span class="co">#this code tells you how many different samples we have within the SITE column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">unique</span>(itex<span class="sc">$</span>SITE) <span class="co">#you can also do this and then it gives you the name of all samples within the SITE column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "ALEXFIORD"    "ANWR"         "ATQASUK"      "AUDKULUHEIDI" "BARROW"      
 [6] "BROOKS"       "BYLOT"        "DOVRE"        "ENDALEN"      "FAROE"       
[11] "GAVIA"        "KLUANE"       "KYTALYK"      "LATNJA"       "NIWOT"       
[16] "QHI"          "SADVENT"      "STEPSTONES"   "TAISETSU"     "THINGVELLIR" 
[21] "TIBET"        "TOOLIK"       "TORNGATS"     "VALBERCLA"   </code></pre>
</div>
</div>
</div>
</section>
<section id="exercises" class="slide level2">
<h2>Exercises</h2>
<p>Ex. 1 - Using the ITEX diversity dataset, what is the relationship between diversity and temperature across sites?</p>
<ul>
<li class="fragment">Think about what will be the response variable, what to include as fixed effects and what to include as a random effect.</li>
<li class="fragment">Does the summary output correspond to the structure of the data? - Think about how the data was sampled and how you structured your model.</li>
</ul>
<div class="fragment">
<p>Ex. 2 - What is the relationship between diversity and temperature WITHIN sites?</p>
</div>
<ul>
<li class="fragment">Think about how to restructure your model based on the new question.</li>
</ul>
<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Hierarchical_Linear_Models_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Hierarchical_Linear_Models_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Hierarchical_Linear_Models_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Hierarchical_Linear_Models_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Hierarchical_Linear_Models_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Hierarchical_Linear_Models_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Hierarchical_Linear_Models_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Hierarchical_Linear_Models_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Hierarchical_Linear_Models_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Hierarchical_Linear_Models_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>