<!DOCTYPE html>
<html lang="en"><head>
<script src="Hierarchical_Linear_Models_files/libs/clipboard/clipboard.min.js"></script>
<script src="Hierarchical_Linear_Models_files/libs/quarto-html/tabby.min.js"></script>
<script src="Hierarchical_Linear_Models_files/libs/quarto-html/popper.min.js"></script>
<script src="Hierarchical_Linear_Models_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Hierarchical_Linear_Models_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Hierarchical_Linear_Models_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Hierarchical_Linear_Models_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Hierarchical_Linear_Models_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="Hierarchical_Linear_Models_files/libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="Hierarchical_Linear_Models_files/libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.551">

  <meta name="author" content="Camila Pacheco">
  <meta name="author" content="Katrín Björnsdóttir">
  <title>Linear and Hierarchical Linear Models</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Hierarchical_Linear_Models_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Hierarchical_Linear_Models_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2; background-color: #2e3440; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #75715e; } /* Annotation */
    code span.at { color: #f92672; } /* Attribute */
    code span.bn { color: #ae81ff; } /* BaseN */
    code span.bu { color: #66d9ef; } /* BuiltIn */
    code span.cf { color: #f92672; } /* ControlFlow */
    code span.ch { color: #e6db74; } /* Char */
    code span.cn { color: #ae81ff; } /* Constant */
    code span.co { color: #75715e; } /* Comment */
    code span.cv { color: #75715e; } /* CommentVar */
    code span.do { color: #75715e; } /* Documentation */
    code span.dt { color: #66d9ef; font-style: italic; } /* DataType */
    code span.dv { color: #ae81ff; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #a6e22e; font-weight: bold; } /* Extension */
    code span.fl { color: #ae81ff; } /* Float */
    code span.fu { color: #a6e22e; } /* Function */
    code span.im { color: #f92672; } /* Import */
    code span.in { color: #f1fa8c; } /* Information */
    code span.kw { color: #f92672; } /* Keyword */
    code span.op { color: #f8f8f2; } /* Operator */
    code span.ot { color: #a6e22e; } /* Other */
    code span.pp { color: #f92672; } /* Preprocessor */
    code span.re { color: #75715e; } /* RegionMarker */
    code span.sc { color: #ae81ff; } /* SpecialChar */
    code span.ss { color: #e6db74; } /* SpecialString */
    code span.st { color: #e6db74; } /* String */
    code span.va { color: #f8f8f2; } /* Variable */
    code span.vs { color: #e6db74; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
  </style>
  <link rel="stylesheet" href="Hierarchical_Linear_Models_files/libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="styles.css">
  <link href="Hierarchical_Linear_Models_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Hierarchical_Linear_Models_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Hierarchical_Linear_Models_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Hierarchical_Linear_Models_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Linear and Hierarchical Linear Models</h1>
  <p class="subtitle">Mixed Models, and Multilevel Models, GLMMs, etc…</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Camila Pacheco 
</div>
</div>
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Katrín Björnsdóttir 
</div>
</div>
</div>

</section>
<section id="today" class="slide level2">
<h2>Today</h2>
<ul>
<li class="fragment">Linear Models</li>
<li class="fragment">What are hierarchical linear models</li>
<li class="fragment">Identify situations in which the use of mixed effects is appropriate</li>
<li class="fragment">Implement basic linear mixed models (LMM) with <code>R</code></li>
<li class="fragment">Break <i class="fa-solid fa-face-smile" aria-label="face-smile"></i></li>
<li class="fragment">Practice</li>
</ul>
<div class="fragment">
<p><img src="https://media1.tenor.com/m/oTeBa4EVepMAAAAC/business-cat-working.gif"></p>
</div>
</section>
<section id="required-material" class="slide level2">
<h2>Required Material</h2>
<p>https://github.com/lacapary/BIO503/</p>
</section>
<section id="required-material-1" class="slide level2">
<h2>Required Material</h2>
<p>You are required to have downloaded and installed</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"lme4"</span>,</span>
<span id="cb1-2"><a href=""></a>                      <span class="st">"ggeffects"</span>,</span>
<span id="cb1-3"><a href=""></a>                      <span class="st">"stargazer"</span></span>
<span id="cb1-4"><a href=""></a>                      ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="required-material-2" class="slide level2">
<h2>Required Material</h2>
<div class="v-center-container">
<h4>
Do not hesitate to ask questions!
</h4>
</div>
</section>
<section id="linear-models" class="slide level2">
<h2>Linear models</h2>
<p>What is a linear model?</p>
<ul>
<li class="fragment"><p>A mathematical tool used to describe the relationship between a <em>response variable</em> and an <em>explanatory variable</em>.</p></li>
<li class="fragment"><p>In the simplest form is expressed as:<br>
</p></li>
<li class="fragment"><p><span class="math inline">\(Y = \beta_0 + \beta_1 X + \varepsilon\)</span>.</p></li>
</ul>
</section>
<section id="linear-models-1" class="slide level2">
<h2>Linear models</h2>
<p>A simple example:</p>
<p>Does soil nitrogen content influence plant productivity?</p>
<p style="font-size: 1.2em;">
</p><p>Plant biomass = β₀ + β₁ · Soil nitrogen + ε</p>
<p></p>
</section>
<section id="linear-models-2" class="slide level2">
<h2>Linear Models</h2>
<p>A simple example:</p>
<p>Does soil nitrogen content influence plant productivity?</p>
<p style="font-size: 1.2em;">
</p><p><span style="color: red; font-weight: bold;">Plant biomass</span> = β₀ + β₁ · Soil nitrogen + ε</p>
<p></p>
<p style="margin-top: -10px;">
</p><p>↑ <span style="font-size: 0.8em;">Response variable</span></p>
<p></p>
</section>
<section id="linear-models-3" class="slide level2">
<h2>Linear Models</h2>
<p>A simple example:</p>
<p>Does soil nitrogen content influence plant productivity?</p>
<p style="font-size: 1.2em;">
</p><p>Plant biomass = β₀ + β₁ · <span style="color: red; font-weight: bold;">Soil nitrogen</span> + ε</p>
<p></p>
<p style="position: relative; left: 150px; margin-top: -20px;">
</p><p>↑ <span style="font-size: 0.8em;">Explanatory variable</span></p>
<p></p>
</section>
<section id="linear-models-4" class="slide level2">
<h2>Linear models</h2>

<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-2-1.png" width="960" class="r-stretch"></section>
<section id="linear-models-5" class="slide level2">
<h2>Linear models</h2>
<p>Why do we use linear models in ecology?</p>
<ul>
<li class="fragment"><p>Ecological systems are <em>complex</em>, but linear models give us a <em>simplified</em> framework to ask and answer key ecological questions.</p>
<ul>
<li class="fragment">✅ Simple and interpretable: Easy to understand and communicate.<br>
</li>
<li class="fragment">✅ Flexible: Can be extended .<br>
</li>
<li class="fragment">✅ Hypothesis testing: Relationships based on ecological theory.<br>
</li>
<li class="fragment">✅ Help to test ecological hypotheses with real-world data.<br>
</li>
<li class="fragment">✅ Foundation for advanced models</li>
</ul></li>
</ul>
</section>
<section id="data-for-this-part-of-the-session" class="slide level2">
<h2>Data for this part of the session</h2>

<img data-src="https://static1.srcdn.com/wordpress/wp-content/uploads/2022/08/Illustrations-of-various-dragons-from-Dungeons-and-Dragons.jpg" style="width:80.0%" class="r-stretch"><p><a href="https://ourcodingclub.github.io/tutorials/mixed-models/">Coding Club Mixed models</a></p>
</section>
<section id="explore-the-data" class="slide level2">
<h2>Explore the data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href=""></a><span class="fu">load</span>(<span class="st">"CC-Linear-mixed-models/dragons.RData"</span>)</span>
<span id="cb2-3"><a href=""></a></span>
<span id="cb2-4"><a href=""></a>dragons_Bavarian <span class="ot">&lt;-</span> dragons <span class="sc">|&gt;</span> </span>
<span id="cb2-5"><a href=""></a>  <span class="fu">filter</span>(mountainRange <span class="sc">==</span> <span class="st">"Bavarian"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="explore-the-data-1" class="slide level2">
<h2>Explore the data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a><span class="fu">head</span>(dragons_Bavarian)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  testScore bodyLength mountainRange site
1 16.147309   165.5485      Bavarian    a
2 33.886183   167.5593      Bavarian    a
3  6.038333   165.8830      Bavarian    a
4 18.838821   167.6855      Bavarian    a
5 33.862328   169.9597      Bavarian    a
6 47.043246   168.6887      Bavarian    a</code></pre>
</div>
</div>
</section>
<section id="explore-the-data-2" class="slide level2">
<h2>Explore the data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a><span class="fu">hist</span>(dragons_Bavarian<span class="sc">$</span>testScore)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch"></section>
<section id="our-question" class="slide level2">
<h2>Our question</h2>
<p>How does body size of dragons influence their intelligence?</p>
</section>
<section id="our-question-1" class="slide level2">
<h2>Our question</h2>
<p>How does body size of dragons influence their intelligence?</p>
<p>First we will plot our DAG:</p>

<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-7-1.png" width="960" class="r-stretch"></section>
<section id="our-question-2" class="slide level2">
<h2>Our question</h2>
<p>How does body size of dragons influence their intelligence?</p>
<p>Then our model:</p>
<p style="font-size: 1.2em;">
</p><p>Test score = β₀ + β₁ · Body length + ε</p>
<p></p>
</section>
<section id="our-question-3" class="slide level2">
<h2>Our question</h2>
<p>Now lets visualize the relationship using ggplot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a>(p <span class="ot">&lt;-</span> dragons_Bavarian <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb6-3"><a href=""></a>    <span class="at">x =</span> bodyLength,</span>
<span id="cb6-4"><a href=""></a>    <span class="at">y =</span> testScore)) <span class="sc">+</span> <span class="co"># to assign a color to each group</span></span>
<span id="cb6-5"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb6-6"><a href=""></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span>    </span>
<span id="cb6-7"><a href=""></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb6-8"><a href=""></a>  <span class="fu">labs</span>(</span>
<span id="cb6-9"><a href=""></a>    <span class="at">x =</span> <span class="st">"Body length"</span>,</span>
<span id="cb6-10"><a href=""></a>    <span class="at">y =</span> <span class="st">"Test score"</span>)</span>
<span id="cb6-11"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"><p style="font-size: 0.6em; font-style: italic;">
Note that putting your entire ggplot code in brackets (<code>()</code>) creates the graph and then shows it in the plot viewer. If you don’t have the brackets, you’ve only created the object, but haven’t visualized it. You would then have to call the object such that it will be displayed by just typing <code>p</code> after you’ve created the “p” object.
</p>
</section>
<section id="lets-model-it" class="slide level2">
<h2>Lets model it</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a>basic.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(testScore <span class="sc">~</span> bodyLength, <span class="at">data =</span> dragons_Bavarian)</span>
<span id="cb7-2"><a href=""></a><span class="fu">summary</span>(basic.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = testScore ~ bodyLength, data = dragons_Bavarian)

Residuals:
    Min      1Q  Median      3Q     Max 
-26.433  -8.228  -0.594   6.893  31.637 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) -44.8343    32.3344  -1.387   0.1709  
bodyLength    0.3777     0.1795   2.104   0.0397 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.35 on 58 degrees of freedom
Multiple R-squared:  0.07093,   Adjusted R-squared:  0.05491 
F-statistic: 4.428 on 1 and 58 DF,  p-value: 0.0397</code></pre>
</div>
</div>
</section>
<section id="factorial-anova-its-just-a-linear-model" class="slide level2">
<h2>Factorial ANOVA: It’s Just a Linear Model</h2>
<ul>
<li class="fragment"><p><em>Factorial ANOVA</em> is a special kind of analysis used when you have two or more categorical predictors.</p></li>
<li class="fragment"><p>But in R, you don’t need a special ANOVA function. You can just use the <code>lm()</code> function.</p></li>
<li class="fragment"><p>That’s because factorial ANOVA is just a <em>linear model</em> with categorical predictors.</p></li>
</ul>
</section>
<section id="factorial-anova-example" class="slide level2">
<h2>Factorial ANOVA: Example</h2>
<p>Using the <code>iris</code> data set.</p>
<p>This fits a linear model where Species is treated as a factor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sepal.Length <span class="sc">~</span> Species, <span class="at">data =</span> iris)</span>
<span id="cb9-2"><a href=""></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sepal.Length ~ Species, data = iris)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.6880 -0.3285 -0.0060  0.3120  1.3120 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         5.0060     0.0728  68.762  &lt; 2e-16 ***
Speciesversicolor   0.9300     0.1030   9.033 8.77e-16 ***
Speciesvirginica    1.5820     0.1030  15.366  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5148 on 147 degrees of freedom
Multiple R-squared:  0.6187,    Adjusted R-squared:  0.6135 
F-statistic: 119.3 on 2 and 147 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="factorial-anova-example-1" class="slide level2">
<h2>Factorial ANOVA: Example</h2>
<p>When we run the ANOVA, we’re checking if the average sepal length is about the same for all the species, or if at least one species is different from the others.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href=""></a><span class="fu">anova</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Sepal.Length
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
Species     2 63.212  31.606  119.26 &lt; 2.2e-16 ***
Residuals 147 38.956   0.265                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="factorial-anova-post-hoc-analysis" class="slide level2">
<h2>Factorial ANOVA: Post-Hoc Analysis</h2>
<ul>
<li class="fragment"><p>Let’s say we run an ANOVA and find a significant result.</p></li>
<li class="fragment"><p>The test: “There’s a difference somewhere”</p></li>
<li class="fragment"><p>The post-hoc test: “Who’s different from who”</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a><span class="fu">library</span>(emmeans)</span>
<span id="cb13-2"><a href=""></a><span class="co"># Get estimated marginal means</span></span>
<span id="cb13-3"><a href=""></a>em <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span> Species)</span>
<span id="cb13-4"><a href=""></a></span>
<span id="cb13-5"><a href=""></a><span class="co"># Pairwise comparisons with Tukey adjustment</span></span>
<span id="cb13-6"><a href=""></a><span class="fu">pairs</span>(em, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast               estimate    SE  df t.ratio p.value
 setosa - versicolor      -0.930 0.103 147  -9.033  &lt;.0001
 setosa - virginica       -1.582 0.103 147 -15.366  &lt;.0001
 versicolor - virginica   -0.652 0.103 147  -6.333  &lt;.0001

P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
</section>
<section id="factorial-anova-post-hoc-analysis-1" class="slide level2">
<h2>Factorial ANOVA: Post-Hoc Analysis</h2>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>Use post-hoc tests only if your ANOVA result is significant.</p>
</div>
</div>
</div>

<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-13-1.png" width="960" class="r-stretch"></section>
<section id="generalize-linear-models" class="slide level2">
<h2>Generalize linear models</h2>
<p>Get familiar with different data distributions Here is a brief summary of the data distributions you might encounter most often.</p>
<ul>
<li class="fragment">Gaussian - Continuous data (normal distribution and homoscedasticity assumed)</li>
<li class="fragment">Poisson - Count abundance data (integer values, zero-inflated data, left-skewed data)</li>
<li class="fragment">Binomial - Binary variables (TRUE/FALSE, 0/1, presence/absence data)</li>
</ul>
<div class="fragment">
<p>Choosing the right statistical test for your analysis is an important step about which you should think carefully.</p>
</div>
</section>
<section id="generalize-linear-models-1" class="slide level2">
<h2>Generalize linear models</h2>
<div style="background-color:white; display:inline-block; padding: 10px;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://ourcodingclub.github.io/assets/img/tutorials/modelling/DL_intro_lm_which.png"></p>
<figcaption>lm which</figcaption>
</figure>
</div>
</div>
</section>
<section id="generalize-linear-models-2" class="slide level2">
<h2>Generalize linear models</h2>
<p>Syntax for a model with poisson (count) distribution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href=""></a><span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">family =</span> poisson, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Syntax for a model with binomial distribution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href=""></a><span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">family =</span> binomial, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="break" class="slide level2">
<h2>BREAK</h2>

<img data-src="https://assets-global.website-files.com/647888ca92d03e3fca3f1ea0/647888ca92d03e3fca3f2376_shutterstock_792140977.jpg" style="width:100.0%" class="r-stretch"></section>
<section id="hierarchical-linear-models" class="slide level2">
<h2>Hierarchical Linear Models</h2>
</section>
<section id="ecological-and-biological-data-can-be-complex" class="slide level2">
<h2>Ecological and biological data can be complex!</h2>
<ul>
<li class="fragment"><p>Hierarchical structure in the data</p></li>
<li class="fragment"><p>Many covariates and grouping factors</p></li>
<li class="fragment"><p>Unbalanced study/experimental design</p></li>
</ul>
</section>
<section id="hierarchical-structres-example" class="slide level2">
<h2>Hierarchical structres example</h2>

<img data-src="Hierarchical_Linear_Models_files/Figures/hierarchical_example.png" style="width:100.0%" class="r-stretch"></section>
<section id="what-is-independence-assumption" class="slide level2">
<h2>What is Independence Assumption?</h2>
<p>In basic statistical models, we assume each observation gives us <strong>new, independent information</strong>.</p>
<div class="fragment">
<p><em>What happens in one sample shouldn’t depend on what happened in another.</em></p>
</div>
</section>
<section id="hierarchical-structres-in-ecology" class="slide level2">
<h2>Hierarchical structres in ecology</h2>
<ul>
<li class="fragment">Measurements from the <strong>same plot or site</strong> are often more similar.</li>
<li class="fragment">Observations from the <strong>same species</strong> might behave similarly.</li>
<li class="fragment">Samples collected <strong>close in time or space</strong> can be correlated.</li>
</ul>
<div class="fragment">
<!-- -->
<h3 id="analogy">Analogy 💡</h3>
<blockquote>
<p>Measuring the same tree’s height 3 times isn’t the same as measuring 3 different trees.</p>
</blockquote>
<div class="fragment">
<p>We call this <strong>dependence</strong> — and we need special models to handle it!</p>
</div>
</div>
</section>
<section id="diagnosing-dependence" class="slide level2">
<h2>Diagnosing dependence</h2>
<p>Ask yourself:</p>
<p><strong>Are there clusters in my data?</strong></p>
<p>Are data points grouped by site, species, individual, or time?</p>
</section>
<section id="how-could-we-analyze-this-data" class="slide level2">
<h2>How could we analyze this data?</h2>
<p>We need to account for correlation in the data.</p>
<ul>
<li class="fragment">LINEAR MIXED MODELS</li>
</ul>
<div class="fragment">
<p>The <em>random effects</em> structure will aid correct inference about <em>fixed effects</em>, depending on which level of the system’s hierarchy is being manipulated.</p>
</div>
<ul>
<li class="fragment">What is random effects ?</li>
<li class="fragment">What is fixed effects?</li>
<li class="fragment">When to used them ?</li>
</ul>
</section>
<section id="fixed-effects-deterministic-processes" class="slide level2">
<h2>Fixed effects : deterministic processes</h2>
<ul>
<li class="fragment"><p>They are like drivers, categories or groups that you think might directly influence the outcome you’re studying.</p></li>
<li class="fragment"><p>They’re called “<em>fixed</em>” because you want to estimate the effect of each level</p></li>
<li class="fragment"><p><code>"I want to know how these different things (fixed effects) affect the outcome."</code></p></li>
</ul>
</section>
<section id="random-effects-stochastic-processes" class="slide level2">
<h2>Random effects : stochastic processes</h2>
<ul>
<li class="fragment"><p>Name random doesn’t have much to do with mathematical randomness</p></li>
<li class="fragment"><p>Grouping variables you want to control for</p></li>
<li class="fragment"><p>You’re not interested in each level individually</p></li>
<li class="fragment"><p>but we know that they might be influencing the patterns we see</p></li>
<li class="fragment"><p><code>"I want to know how these factors (random effects) contribute to the overall variation in the outcome."</code></p></li>
<li class="fragment"><p>They are always categorical</p></li>
<li class="fragment"><p>Examples: Site, Observer, Year</p></li>
</ul>
</section>
<section id="when-do-we-use-them" class="slide level2">
<h2>When do we use them?</h2>
<ul>
<li class="fragment"><p>Whenever your data has hierarchical structure.</p></li>
<li class="fragment"><p>The choice depends on the research question</p></li>
<li class="fragment"><p>Is the variable a source of variation or the target of inference?</p></li>
</ul>
</section>
<section id="active-break" class="slide level2">
<h2>Active break 💡</h2>
<p>Scenario: You measured plant height across 6 sites, with different treatments at each site.</p>
<p>Questions:</p>
<ul>
<li class="fragment"><p>What could be a fixed effect?</p></li>
<li class="fragment"><p>What could be a random effect?</p></li>
<li class="fragment"><p>What would happen if you ignored site?</p></li>
</ul>
</section>
<section id="dragon-data" class="slide level2">
<h2>Dragon data</h2>
<p>We went to the field and sampled more mountains with dragons.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 3
# Groups:   mountainRange [8]
   mountainRange site  samples
   &lt;fct&gt;         &lt;fct&gt;   &lt;int&gt;
 1 Bavarian      a          20
 2 Bavarian      b          20
 3 Bavarian      c          20
 4 Central       a          20
 5 Central       b          20
 6 Central       c          20
 7 Emmental      a          20
 8 Emmental      b          20
 9 Emmental      c          20
10 Julian        a          20
# ℹ 14 more rows</code></pre>
</div>
</div>
<h3 id="research-question">Research question</h3>
<div class="v-center-container">
<h4>
Is the test score affected by body length?
</h4>
</div>
</section>
<section id="dragons-linear-model" class="slide level2">
<h2>Dragons Linear model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href=""></a>basic.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(testScore <span class="sc">~</span> bodyLength2, <span class="at">data =</span> dragons)</span>
<span id="cb18-2"><a href=""></a><span class="fu">summary</span>(basic.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = testScore ~ bodyLength2, data = dragons)

Residuals:
    Min      1Q  Median      3Q     Max 
-56.962 -16.411  -0.783  15.193  55.200 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  50.3860     0.9676  52.072   &lt;2e-16 ***
bodyLength2   8.9956     0.9686   9.287   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 21.2 on 478 degrees of freedom
Multiple R-squared:  0.1529,    Adjusted R-squared:  0.1511 
F-statistic: 86.25 on 1 and 478 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="dragons-linear-model-1" class="slide level2">
<h2>Dragons Linear model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href=""></a>(prelim_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dragons, <span class="fu">aes</span>(<span class="at">x =</span> bodyLength, <span class="at">y =</span> testScore)) <span class="sc">+</span></span>
<span id="cb20-2"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-3"><a href=""></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>))<span class="sc">+</span></span>
<span id="cb20-4"><a href=""></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-21-1.png" width="960" class="r-stretch"></section>
<section id="assumptions-check" class="slide level2">
<h2>Assumptions check</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href=""></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(model)); <span class="fu">qqline</span>(<span class="fu">resid</span>(model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-22-1.png" width="960" class="r-stretch"></section>
<section id="assumptions-check-1" class="slide level2">
<h2>Assumptions check</h2>
<div class="v-center-container">
<h4>
Are our data independent?
</h4>
</div>

<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-23-1.png" width="960" class="r-stretch"><ul>
<li class="fragment">They are Hierarchical!</li>
<li class="fragment">Our research question:
<ul>
<li class="fragment">Does a dragon’s body length predict its test score, after accounting for variation across mountain ranges?</li>
</ul></li>
</ul>
</section>
<section id="assumptions-check-2" class="slide level2">
<h2>Assumptions check</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href=""></a>(colour_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dragons, <span class="fu">aes</span>(<span class="at">x =</span> bodyLength, <span class="at">y =</span> testScore, <span class="at">colour =</span> mountainRange)) <span class="sc">+</span></span>
<span id="cb22-2"><a href=""></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb22-3"><a href=""></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb22-4"><a href=""></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-24-1.png" width="960" class="r-stretch"></section>
<section id="how-to-implement-mixed-models-in-r" class="slide level2">
<h2>How to implement mixed models in R?</h2>
<ul>
<li class="fragment">Step 1: Model building</li>
<li class="fragment">Step 2: Model validation</li>
<li class="fragment">Step 3: Model interpretation</li>
<li class="fragment">Step 4: Model visualization</li>
</ul>
</section>
<section id="step-1-model-building" class="slide level2">
<h2>Step 1: Model building</h2>
<p>Hierarchical linear models do is they essentially fit a separate regression line for each and every cluster. And then estimates what we call the <em>Fixed slope</em>. Average slope between x and y across my clusters.</p>
</section>
<section id="step-1-model-building-dragons" class="slide level2">
<h2>Step 1: Model building Dragons</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" data-code-line-numbers="|1|2|3|4|5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href=""></a><span class="fu">library</span>(lme4) <span class="co">#"linear mixed model" function from lme4 package</span></span>
<span id="cb23-2"><a href=""></a>mixed.lmer <span class="ot">&lt;-</span> <span class="fu">lmer</span>(testScore <span class="sc">~</span> bodyLength2 <span class="sc">+</span></span>
<span id="cb23-3"><a href=""></a>                     (<span class="dv">1</span><span class="sc">|</span>mountainRange<span class="sc">/</span>site), <span class="co">#random effect</span></span>
<span id="cb23-4"><a href=""></a>                   <span class="at">data =</span> dragons,</span>
<span id="cb23-5"><a href=""></a>                   <span class="at">REML =</span> <span class="cn">TRUE</span> <span class="co">#estimation method other method ML but it has a bias</span></span>
<span id="cb23-6"><a href=""></a>                   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-2-model-validation-dragons" class="slide level2">
<h2>Step 2: Model validation Dragons</h2>
<p>Assumptions check</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href=""></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(mixed.lmer))</span>
<span id="cb24-2"><a href=""></a><span class="fu">qqline</span>(<span class="fu">resid</span>(mixed.lmer))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-26-1.png" width="960" class="r-stretch"></section>
<section id="step-3-model-interpreation-dragons" class="slide level2">
<h2>Step 3: Model interpreation Dragons</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: testScore ~ bodyLength2 + (1 | mountainRange/site)
   Data: dragons

REML criterion at convergence: 3970.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2425 -0.6752 -0.0117  0.6974  2.8812 

Random effects:
 Groups             Name        Variance Std.Dev.
 site:mountainRange (Intercept)  23.09    4.805  
 mountainRange      (Intercept) 327.56   18.099  
 Residual                       208.58   14.442  
Number of obs: 480, groups:  site:mountainRange, 24; mountainRange, 8

Fixed effects:
            Estimate Std. Error t value
(Intercept)   50.386      6.507   7.743
bodyLength2    0.831      1.681   0.494

Correlation of Fixed Effects:
            (Intr)
bodyLength2 0.000 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href=""></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb26-2"><a href=""></a><span class="fu">r.squaredGLMM</span>(mixed.lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             R2m       R2c
[1,] 0.001233396 0.6274854</code></pre>
</div>
</div>
</section>
<section id="step-4.-visualization" class="slide level2">
<h2>Step 4. Visualization</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" data-code-line-numbers="1|3-4|6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href=""></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb28-2"><a href=""></a></span>
<span id="cb28-3"><a href=""></a><span class="co"># Extract the prediction data frame</span></span>
<span id="cb28-4"><a href=""></a>pred.mm <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(mixed.lmer, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"bodyLength2"</span>))  <span class="co"># this gives overall predictions for the model</span></span>
<span id="cb28-5"><a href=""></a><span class="fu">head</span>(pred.mm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Predicted values of testScore

bodyLength2 | Predicted |       95% CI
--------------------------------------
         -3 |     47.89 | 31.72, 64.07
         -2 |     48.72 | 34.33, 63.12
         -1 |     49.56 | 36.35, 62.76
          0 |     50.39 | 37.60, 63.17
          1 |     51.22 | 38.01, 64.42
          2 |     52.05 | 37.66, 66.44

Adjusted for:
*          site = 0 (population-level)
* mountainRange = 0 (population-level)</code></pre>
</div>
</div>
</section>
<section id="step-4.-visualization-1" class="slide level2">
<h2>Step 4. Visualization</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb30" data-code-line-numbers="|3-4|5-13|13-17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href=""></a><span class="co"># Plot the predictions </span></span>
<span id="cb30-2"><a href=""></a>p<span class="ot">&lt;-</span><span class="fu">ggplot</span>(pred.mm) <span class="sc">+</span></span>
<span id="cb30-3"><a href=""></a>    <span class="co"># slope</span></span>
<span id="cb30-4"><a href=""></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> predicted)) <span class="sc">+</span></span>
<span id="cb30-5"><a href=""></a>    <span class="co"># error band</span></span>
<span id="cb30-6"><a href=""></a>    <span class="fu">geom_ribbon</span>(</span>
<span id="cb30-7"><a href=""></a>      <span class="fu">aes</span>(</span>
<span id="cb30-8"><a href=""></a>        <span class="at">x =</span> x,</span>
<span id="cb30-9"><a href=""></a>        <span class="at">ymin =</span> predicted <span class="sc">-</span> std.error,</span>
<span id="cb30-10"><a href=""></a>        <span class="at">ymax =</span> predicted <span class="sc">+</span> std.error</span>
<span id="cb30-11"><a href=""></a>      ),</span>
<span id="cb30-12"><a href=""></a>      <span class="at">fill =</span> <span class="st">"lightgrey"</span>,</span>
<span id="cb30-13"><a href=""></a>      <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb30-14"><a href=""></a>    ) <span class="sc">+</span></span>
<span id="cb30-15"><a href=""></a>    <span class="co"># adding the raw data (scaled values)</span></span>
<span id="cb30-16"><a href=""></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> dragons,                      </span>
<span id="cb30-17"><a href=""></a>               <span class="fu">aes</span>(<span class="at">x =</span> bodyLength2, <span class="at">y =</span> testScore, <span class="at">colour =</span> mountainRange)) <span class="sc">+</span></span>
<span id="cb30-18"><a href=""></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Body Length (indexed)"</span>,</span>
<span id="cb30-19"><a href=""></a>         <span class="at">y =</span> <span class="st">"Test Score"</span>,</span>
<span id="cb30-20"><a href=""></a>         <span class="at">title =</span> <span class="st">"Body length does not affect intelligence in dragons"</span>) <span class="sc">+</span></span>
<span id="cb30-21"><a href=""></a>    <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-4.-visualization-2" class="slide level2">
<h2>Step 4. Visualization</h2>

<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-31-1.png" width="960" class="r-stretch"></section>
<section id="step-4.-visualization-3" class="slide level2">
<h2>Step 4. Visualization</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" data-code-line-numbers="|3|4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href=""></a>p<span class="ot">&lt;-</span></span>
<span id="cb31-2"><a href=""></a>  <span class="fu">ggpredict</span>(mixed.lmer, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"bodyLength2"</span>, <span class="st">"mountainRange"</span>),</span>
<span id="cb31-3"><a href=""></a>            <span class="at">type =</span> <span class="st">"random"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href=""></a>   <span class="fu">plot</span>(<span class="at">show_ci =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb31-5"><a href=""></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Body Length"</span>, <span class="at">y =</span> <span class="st">"Test Score"</span>, </span>
<span id="cb31-6"><a href=""></a>        <span class="at">title =</span> <span class="st">"Effect of body size on intelligence in dragons"</span>) <span class="sc">+</span> </span>
<span id="cb31-7"><a href=""></a>   <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-4.-visualization-4" class="slide level2">
<h2>Step 4. Visualization</h2>

<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-33-1.png" width="960" class="r-stretch"></section>
<section id="random-slopes-and-random-intercept" class="slide level2">
<h2>Random slopes and Random intercept</h2>
<div class="fragment fade-in">
<p>A random-intercept model allows each cluster (e.g.&nbsp;population) to have its own starting point — some may be smarter or dumber overall.</p>
</div>
<div class="fragment fade-in">
<p>A random-slope model goes further: it lets the effect of a predictor (like body length) vary across clusters. So, one population might show a strong link between body length and intelligence, while another shows little or none.</p>
</div>
</section>
<section id="random-slopes-and-random-intercept-1" class="slide level2">
<h2>Random slopes and Random intercept</h2>
<p>We only need to make one change to our model to allow for random slopes as well as intercept, and that’s adding the fixed variable into the random effect brackets:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32" data-code-line-numbers="|2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href=""></a>mixed.ranslope <span class="ot">&lt;-</span> <span class="fu">lmer</span>(testScore <span class="sc">~</span> bodyLength2 <span class="sc">+</span></span>
<span id="cb32-2"><a href=""></a>                         (<span class="dv">1</span> <span class="sc">+</span> bodyLength2<span class="sc">|</span>mountainRange<span class="sc">/</span>site), </span>
<span id="cb32-3"><a href=""></a>                       <span class="at">data =</span> dragons) </span>
<span id="cb32-4"><a href=""></a></span>
<span id="cb32-5"><a href=""></a><span class="fu">summary</span>(mixed.ranslope)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: testScore ~ bodyLength2 + (1 + bodyLength2 | mountainRange/site)
   Data: dragons

REML criterion at convergence: 3968.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2654 -0.6737 -0.0200  0.6931  2.8432 

Random effects:
 Groups             Name        Variance Std.Dev. Corr 
 site:mountainRange (Intercept)  19.8156  4.4515       
                    bodyLength2   0.7178  0.8472  1.00 
 mountainRange      (Intercept) 310.9691 17.6343       
                    bodyLength2   6.1119  2.4722  -1.00
 Residual                       208.5025 14.4396       
Number of obs: 480, groups:  site:mountainRange, 24; mountainRange, 8

Fixed effects:
            Estimate Std. Error t value
(Intercept)  51.4263     6.3408   8.110
bodyLength2   0.6691     1.8729   0.357

Correlation of Fixed Effects:
            (Intr)
bodyLength2 -0.461
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
</section>
<section id="random-slopes" class="slide level2">
<h2>Random slopes</h2>

<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-35-1.png" width="960" class="r-stretch"></section>
<section id="crossed-effects" class="slide level2">
<h2>Crossed effects</h2>
<p>Example:</p>
<p>10 control | 10 experimental</p>
<ul>
<li class="fragment"><p>3 years</p></li>
<li class="fragment"><p>Each season</p></li>
<li class="fragment"><p>20 beds</p></li>
<li class="fragment"><p>50 seedlings</p></li>
<li class="fragment"><p>5 leaves</p></li>
<li class="fragment"><p>5 leaves x 50 seedlings x 20 beds x 4 seasons x 3 years = 60 000 measurements per treatment</p></li>
<li class="fragment"><p><em>Very hot summer in the second year</em></p></li>
</ul>
</section>
<section id="crossed-effects-1" class="slide level2">
<h2>Crossed effects</h2>

<img data-src="Hierarchical_Linear_Models_files/figure-revealjs/unnamed-chunk-36-1.png" width="960" class="r-stretch"><div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href=""></a>leafLength <span class="sc">~</span> treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Bed<span class="sc">/</span>Plant<span class="sc">/</span>Leaf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What about the crossed effects ?</p>
<div class="fragment">
<p>Crossed (or partially crossed) random factors that do not represent levels in a hierarchy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href=""></a>leafLength <span class="sc">~</span> treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Bed<span class="sc">/</span>Plant<span class="sc">/</span>Leaf) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Season)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="additional-ressources" class="slide level2">
<h2>Additional ressources</h2>
<p>Popular libraries for (G)LMMs:</p>
<ul>
<li class="fragment"><p>Frequentist : <code>nlme</code>, <code>lme4</code>, <code>glmmTMB</code></p></li>
<li class="fragment"><p>Bayesian : <code>brms</code>, <code>rstan</code>, <code>rstanarm</code>, <code>MCMCglmm</code></p></li>
<li class="fragment"><p>Nice visualization : <a href="https://mfviz.com/hierarchical-models/">link</a></p></li>
<li class="fragment"><p>Most of the material comes from : <a href="https://ourcodingclub.github.io/">Coding Club</a></p></li>
</ul>
</section>
<section id="break-1" class="slide level2">
<h2>BREAK</h2>

<img data-src="https://assets-global.website-files.com/647888ca92d03e3fca3f1ea0/647888ca92d03e3fca3f2376_shutterstock_792140977.jpg" style="width:100.0%" class="r-stretch"></section>
<section id="exercise" class="slide level2">
<h2>Exercise</h2>
<p>Now let’s practice …</p>
<div class="fragment">
<p><img src="https://media1.tenor.com/m/hHaVzeiH-hcAAAAC/imsickofwork-technologysu-x.gif"></p>
</div>
</section>
<section id="itex" class="slide level2">
<h2>ITEX</h2>
<p>We will be using a dataset from the ITEX network.</p>
<ul>
<li class="fragment"><p>ITEX is a long-term warming experiment that uses standardized protocols to examine impacts of warming on Arctic ecosystems.</p></li>
<li class="fragment"><p>Established in the 1990s - vegetation monitoring over three decades.</p></li>
<li class="fragment"><p>Uses a simple method that is easy to establish in the field - open top chambers</p></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Hierarchical_Linear_Models_files/Figures/otc.png" style="width:20.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="itex-1" class="slide level2">
<h2>ITEX</h2>

<img data-src="Hierarchical_Linear_Models_files/Figures/audkuluheidi.JPG" style="width:100.0%" class="r-stretch"></section>
<section id="lets-look-at-the-data" class="slide level2">
<h2>Let’s look at the data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href=""></a>itex <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/ITEX_diversity_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href=""></a><span class="fu">head</span>(itex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 11
   ...1 SITE      SUBSITE     PLOT   YEAR TRTMT Latitude WarmQuarterTemp SppRich
  &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;           &lt;dbl&gt;   &lt;dbl&gt;
1     1 ALEXFIORD ALEXFIORD:… Cas.…  2007 CTL       78.9            25.6       9
2     2 ALEXFIORD ALEXFIORD:… Cas.…  2007 CTL       78.9            25.6       9
3     3 ALEXFIORD ALEXFIORD:… Cas.…  2007 CTL       78.9            25.6       7
4     4 ALEXFIORD ALEXFIORD:… Cas.…  2007 CTL       78.9            25.6       8
5     5 ALEXFIORD ALEXFIORD:… Cas.…  2007 CTL       78.9            25.6       6
6     6 ALEXFIORD ALEXFIORD:… Cas.…  2007 CTL       78.9            25.6      10
# ℹ 2 more variables: `row_number()` &lt;dbl&gt;, PlotTemp &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href=""></a><span class="fu">length</span>(<span class="fu">unique</span>(itex<span class="sc">$</span>SITE)) <span class="co">#this code tells you how many different samples we have within the SITE column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href=""></a><span class="fu">unique</span>(itex<span class="sc">$</span>SITE) <span class="co">#you can also do this and then it gives you the name of all samples within the SITE column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "ALEXFIORD"    "ANWR"         "ATQASUK"      "AUDKULUHEIDI" "BARROW"      
 [6] "BROOKS"       "BYLOT"        "DOVRE"        "ENDALEN"      "FAROE"       
[11] "GAVIA"        "KLUANE"       "KYTALYK"      "LATNJA"       "NIWOT"       
[16] "QHI"          "SADVENT"      "STEPSTONES"   "TAISETSU"     "THINGVELLIR" 
[21] "TIBET"        "TOOLIK"       "TORNGATS"     "VALBERCLA"   </code></pre>
</div>
</div>
</div>
</section>
<section id="exercise-1" class="slide level2 scrollable">
<h2>Exercise 1</h2>
<p>Modeling Diversity and Temperature Using the <strong>ITEX diversity dataset </strong>, explore the relationship between <strong>plant diversity</strong> and <strong>temperature</strong> across different sites.</p>
<h3 id="your-tasks">👉 Your Tasks:</h3>
<ol type="1">
<li class="fragment"><strong>Model Planning</strong>:
<ul>
<li class="fragment">What is your <strong>response variable</strong>?</li>
<li class="fragment">Which variables make sense as <strong>fixed effects</strong>?</li>
<li class="fragment">Which variable(s) should be treated as <strong>random effects</strong> (e.g., site, year)?</li>
</ul></li>
<li class="fragment"><strong>Fit the Model</strong>:
<ul>
<li class="fragment">Use <code>lmer()</code> to fit a model to the data.</li>
<li class="fragment">Look at the output with <code>summary()</code>.</li>
</ul></li>
<li class="fragment"><strong>Reflect</strong>:
<ul>
<li class="fragment">Does the model structure reflect <strong>how the data was collected</strong>?</li>
<li class="fragment">Does the summary output <strong>make sense</strong> given your sampling design?</li>
</ul></li>
</ol>
</section>
<section id="exercise-2" class="slide level2 scrollable">
<h2>Exercise 2</h2>
<p>What is the relationship between diversity and temperature <strong>within sites</strong>?</p>
<p>Now that you’ve explored overall patterns, focus your model on how <strong>temperature affects diversity within each site</strong>.</p>
<h4 id="your-tasks-1">👉 Your Tasks:</h4>
<ol type="1">
<li class="fragment"><ul>
<li class="fragment">What changes when we ask about relationships <em>within sites</em> instead of <em>across</em> them?</li>
<li class="fragment">Should you adjust the way <code>site</code> is treated in your model?</li>
</ul></li>
<li class="fragment"><p><strong>Model Check</strong>:</p></li>
<li class="fragment"><p><strong>Fit a New Model (if needed)</strong>:</p>
<ul>
<li class="fragment">Update your <code>lmer()</code> call to reflect this new focus.</li>
<li class="fragment">Reinterpret the output</li>
</ul></li>
</ol>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Hierarchical_Linear_Models_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Hierarchical_Linear_Models_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Hierarchical_Linear_Models_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Hierarchical_Linear_Models_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Hierarchical_Linear_Models_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Hierarchical_Linear_Models_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Hierarchical_Linear_Models_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Hierarchical_Linear_Models_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Hierarchical_Linear_Models_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Hierarchical_Linear_Models_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>